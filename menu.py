from pathlib import Path

# --- é…ç½®åŒº ---
# æŒ‡å‘ä½ çš„ Hugo content ç›®å½•
HUGO_CONTENT_ROOT = Path(r"D:\desktop\ChenGou-zheng.github.io\hugo\content")
# ä½ å¯ä»¥é¢„å®šä¹‰ä¸€äº›ç›®å½•çš„æ˜¾ç¤ºåç§°å’Œé¡ºåº
# æ ¼å¼: "ç›®å½•å": ("æ˜¾ç¤ºåç§°", æƒé‡)
DIRECTORY_CONFIG = {
    "posts": ("åšå®¢", 2),
    "summaries": ("æ€»ç»“", 3),
    "notes": ("ç¬”è®°", 4),
    "ai": ("AI", 5),
    "robot": ("æœºå™¨äºº", 6),
    "tools": ("å·¥å…·", 7),
    "tags": ("æ ‡ç­¾", 8)
}
# --- é…ç½®åŒºç»“æŸ ---

def generate_menu_config():
    """
    æ‰«æ content ç›®å½•å¹¶ç”Ÿæˆ toml æ ¼å¼çš„èœå•é…ç½®ã€‚
    """
    if not HUGO_CONTENT_ROOT.is_dir():
        print(f"â—ï¸ é”™è¯¯ï¼šç›®å½• '{HUGO_CONTENT_ROOT}' ä¸å­˜åœ¨ã€‚")
        return

    print(f"ğŸ” æ­£åœ¨æ‰«æç›®å½•: {HUGO_CONTENT_ROOT}\n")
    
    # å­˜å‚¨æ‰¾åˆ°çš„ç›®å½•åŠå…¶é…ç½®
    menu_items = []
    
    # æ€»æ˜¯å…ˆæ·»åŠ å›ºå®šçš„é¦–é¡µ
    menu_items.append({
        "name": "é¦–é¡µ",
        "url": "/",
        "weight": 1
    })

    # æ‰«æä¸€çº§å­ç›®å½•
    for item in HUGO_CONTENT_ROOT.iterdir():
        if item.is_dir():
            dir_name = item.name
            
            # ä»é¢„å®šä¹‰é…ç½®ä¸­è·å–æ˜¾ç¤ºåç§°å’Œæƒé‡
            config = DIRECTORY_CONFIG.get(dir_name)
            
            if config:
                display_name, weight = config
                menu_items.append({
                    "name": display_name,
                    "url": f"/{dir_name}/",
                    "weight": weight
                })
            else:
                # å¦‚æœæ²¡æœ‰é¢„å®šä¹‰ï¼Œä½¿ç”¨ç›®å½•åä½œä¸ºæ˜¾ç¤ºåç§°ï¼Œå¹¶ç»™ä¸€ä¸ªé»˜è®¤çš„é«˜æƒé‡
                print(f"ğŸ”” å‘ç°æœªé…ç½®çš„ç›®å½• '{dir_name}'ï¼Œå°†ä½¿ç”¨é»˜è®¤è®¾ç½®ã€‚")
                menu_items.append({
                    "name": dir_name.capitalize(),
                    "url": f"/{dir_name}/",
                    "weight": 99 # æ”¾åœ¨æœ€å
                })
    
    # æŒ‰æƒé‡æ’åº
    menu_items.sort(key=lambda x: x['weight'])
    
    # --- ç”Ÿæˆ toml è¾“å‡º ---
    print("="*40)
    print("# è¯·å°†ä»¥ä¸‹å†…å®¹å¤åˆ¶åˆ°ä½ çš„ hugo.toml æ–‡ä»¶ä¸­ï¼Œæ›¿æ¢æ‰æ—§çš„ [[menu.main]] éƒ¨åˆ†")
    print("# Generated by generate_menu.py")
    print("="*40 + "\n")

    for item in menu_items:
        print("[[menu.main]]")
        print(f'  name = "{item["name"]}"')
        print(f'  url = "{item["url"]}"')
        print(f'  weight = {item["weight"]}')
        print("") # ç©ºè¡Œä»¥åˆ†éš”

if __name__ == "__main__":
    generate_menu_config()
